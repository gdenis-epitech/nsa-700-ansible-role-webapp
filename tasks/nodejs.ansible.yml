---
- name: "Load NodeJS variables"
  ansible.builtin.include_vars: nodejs.vars.ansible.yml

- name: "Install package dependencies"
  ansible.builtin.apt:
    update_cache: true
    force: true
    package:
      - ca-certificates
      - apt-transport-https

- name: "Install NVM"
  ansible.builtin.shell: >
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
  args:
    creates: "/home/ansible/.nvm/nvm.sh"
  become: true
  become_user: ansible

- name: "Install NodeJS"
  ansible.builtin.shell: >
    source /home/ansible/.nvm/nvm.sh && nvm install 10.13.0
  args:
    executable: /bin/bash
  register: out
  changed_when: out.rc != 0
  become: true
  become_user: ansible
